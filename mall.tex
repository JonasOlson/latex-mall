\documentclass[a4paper, article, oneside, leqno]{memoir}

\makeatletter
\def\@arabic#1{\number\numexpr#1-1\relax}
\makeatother

\usepackage{fontspec}
\usepackage{polyglossia}
\setdefaultlanguage{swedish}
\usepackage{datetime}
\renewcommand{\dateseparator}{-}
\usepackage[inline]{enumitem}

\usepackage[hyperref, table, dvipsnames, svgnames, x11names]{xcolor}

% Paketet svg möjliggör SVG-bilder, och kräver också några rader bugfix.
\usepackage{pdftexcmds}
\makeatletter
\let\pdfstrcmp\pdf@strcmp
\let\pdffilemoddate\pdf@filemoddate
\makeatother
\usepackage{svg}

% Gör att mellanslag i bildfilnamn fungerar.
\usepackage[space]{grffile}

% Matematik
\usepackage[intlimits]{mathtools}
\usepackage{amssymb}
\usepackage{mathrsfs}

\usepackage[unicode]{hyperref}

% Kodlistning
\usepackage[minted, skins, breakable]{tcolorbox}
\tcbset{
  breakable,
  skin=enhancedmiddle jigsaw,
  colback=GhostWhite,
  boxrule=0mm,
  boxsep=0mm,
  top=0mm,
  bottom=0mm,
  right=0mm,
  left=0mm,
  listing only,
  minted options={
    linenos,
    autogobble=true,
    breaklines,
    breakautoindent=false,
    breaksymbolleft=\tiny\ensuremath{\hookrightarrow},
    breaksymbolright=\tiny\ensuremath{\hookleftarrow},
    breaksymbolindentleft=0ex,
    breaksymbolindentright=0ex,
    breaksymbolsepleft=0.8ex,
    breaksymbolsepright=0.8ex,
    mathescape=true, % Möjliggör matematiska uttryck i kommentarer
    python3=true, % Endast aktuellt för PythonConsoleLexer
    frame=lines,
    framesep=1.2ex,
    baselinestretch=1.2,
    fontsize=\footnotesize,
    numbersep=1.6ex,
    xleftmargin=0.4ex,
    xrightmargin=0.4ex
  }
}
\setminted[]{
  linenos,
  autogobble=true,
  breaklines,
  breakautoindent=false,
  breaksymbolleft=\tiny\ensuremath{\hookrightarrow},
  breaksymbolright=\tiny\ensuremath{\hookleftarrow},
  breaksymbolindentleft=0ex,
  breaksymbolindentright=0ex,
  breaksymbolsepleft=0.8ex,
  breaksymbolsepright=0.8ex,
  mathescape=true, % Möjliggör matematiska uttryck i kommentarer
  python3=true, % Endast aktuellt för PythonConsoleLexer
  frame=lines,
  framesep=1.2ex,
  baselinestretch=1.2,
  fontsize=\footnotesize,
  numbersep=1.6ex,
  xleftmargin=0.4ex,
  xrightmargin=0.4ex
}
\renewcommand{\theFancyVerbLine}{\rmfamily\textcolor{GhostWhite!50!black}{\tiny\arabic{FancyVerbLine}}} % Utseende för radnumrering i kod

\newtcbinputlisting{externallisting}[3]{listing file={#2#3}, minted options={label={#3}}, minted language={#1}}

\newtcblisting{internallisting}[1]{minted language=#1}

\title{Rubrik}
\author{Författare}
%\date{\today\ (\currenttime)}

\hypersetup{
  pdftitle={\thetitle},
  pdfauthor={\theauthor}
}

\begin{document}
\maketitle

\chapter{Listor}

% Lista i löpande text
En Renult består av
\begin{enumerate*}[label=(\alph*)]
\item fyra hjul och
\item en bult.
\end{enumerate*}
Kroppens fyra delar är
\begin{enumerate}
\item huvud,
\item axlar,
\item knä och
\item tå.
\end{enumerate}

\chapter{Matematik}

\section{Olika sätt att justera ekvationer}
\begin{gather}
  a_0+a_1=b_1\\
  a_2=b_2+c_2-d_2+e_2
\end{gather}
\begin{align}
  a_0+a_1&=b_1\\
  a_2&=b_2+c_2-d_2+e_2
\end{align}
\section{Radbruten ekvation}
\begin{gather}
  \begin{multlined}[b]
    s+s+s+s+s+s+s+s+s+s+s+s+s\\
    +t+t+t+t+t+t+t+t+t+t
  \end{multlined}\\
  a=b
\end{gather}

\section{Vektorer och delekvationer}
Newton säger oss att $\mathbf{F}_i = -Gmm_i(\mathbf{r}-\mathbf{r}_i)/|\mathbf{r}-\mathbf{r}_i|^3$ och därutöver att
\begin{subequations}
  \label{eq:subequations}
  \begin{gather}
    \mathbf{F} = \sum_{i=0}^{n-1} \mathbf{F}_i, \label{eq:kraftsumma} \\
    \mathbf{F} = m\mathbf{a} \label{eq:kraftlag}, \\
    \mathbf{a} = \dot{\mathbf{v}} = \ddot{\mathbf{r}}.
  \end{gather}
\end{subequations}
Hänvisningar till ekvationer: \ref{eq:subequations} \ref{eq:kraftsumma} \ref{eq:kraftlag}. En fet grek: $\boldsymbol{\beta}$.

\section{Flerfallsfunktioner och inskjuten text}

\begin{align}
  a &=
  \begin{dcases*}
    \int_0^\infty \mathrm{e}^{-x}\,\mathrm{d}x & om $\int_0^\infty$ är positiv\\
    -x & annars
  \end{dcases*} \\
  f(x) &=
  \begin{dcases}
    \int_0^\infty, & \int_0^\infty > 0 \\
    x, & x < 0
  \end{dcases} \\
  \shortintertext{och slutligen}
  f(x^2z+3\times 84) &=
  \begin{cases}
    \int_0^\infty, & \int_0^\infty > 0 \\
    x, & x < 0
  \end{cases}
\end{align}

\chapter{Flytande objekt}

En JPEG-bild (figur~\ref{fig:bänk}), en SVG-bild (figur~\ref{fig:smith}) och en tabell (tabell~\ref{tab:stilla}).

\begin{figure}[ht]
  \centering
  \includegraphics[width=0.9\textwidth]{bänk.jpeg}
  \caption{Ad majorem\,--\,finstrukturkonstanten\,--\,Dei gloriam}
  \label{fig:bänk}
\end{figure}

\begin{figure}[ht]
  \centering
  \includesvg[width=0.5\textwidth]{Smithdiagram}
  \caption{Smithdiagram}
  \label{fig:smith}
\end{figure}

\begin{table}[ht]  
  \centering
  \begin{tabular}{ll}
    \toprule
    veckodag & namn \\
    \midrule
    söndag & palmsöndagen \\
    måndag & blåmåndagen \\
    tisdag & vita tisdagen \\
    onsdag & dymmelonsdag \\
    torsdag & skärtorsdag \\
    fredag & långfredagen \\
    lördag & påskafton \\
    (söndag) & (påskdagen) \\
    \bottomrule
  \end{tabular}
  \caption{Stilla veckan}
  \label{tab:stilla}
\end{table}

\appendix
\chapter{Kodutskrift}

Kör \mintinline{bash}{pygmentize -L} för att få en lista över tillgängliga språk och färgscheman.

\section{Intern kod (direkt i LaTeX-filen)}

\begin{internallisting}{haskell}
  f x = map (\f -> f x) f
  let a x = baklängesmap [sin, cos] x
  let b x = map (\x -> x^2) x
  let c x = foldl (+) 0 x
  r <- (randomIO :: IO Float)
  (c.b.a) r
\end{internallisting}

\section{Extern kod (från separat fil)}

Det första av de två sökvägsargumenten är ett prefix som används för att hitta filen, men som inte visas i det färdiga dokumentet.

\externallisting{c}{listings/}{duff.c}

\end{document}
